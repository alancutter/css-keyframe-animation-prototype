<script src="animation_engine.js"></script>
<script src="utility.js"></script>
<script src="style_environment.js"></script>
<script src="keyframe_effect.js"></script>
<script src="interpolation.js"></script>
<script src="animation_type_mapping.js"></script>
<script src="default_animation_type.js"></script>
<script src="length_animation_type.js"></script>
<script src="number_animation_type.js"></script>

<style>
#test {
  width: 400px;
  border: solid;
}

.ball {
  position: absolute;
  width: 40px;
  height: 40px;
  border-radius: 50%;
}

#ballpit > .ball:nth-child(2n) {
    background: black;
}
#ballpit > .ball:nth-child(2n+1) {
    background: orange;
}
</style>

<div id="test">Click me</div>
<div id="ballpit"></div>

<body>
<script>
test.addEventListener('click', function() {
  test.textContent = 'This should animate line-height from 0 to 2.5 for 1s then snap to 5.';
  test.animate([
    {'line-height': '0'},
    {'line-height': '0'},
  ], 2000);
  test.animate([
    {'line-height': '5px'},
  ], 2000);
  test.animate([
    {'line-height': '5', composite: 'add'},
  ], 2000);
});

function forRange(n, f) {
  for (var i = 0; i < n; i++) {
    f(i);
  }
}

forRange(10, function(i) {
  var duration = (i + 1) * 500;
  var ball = document.createElement('div');
  ball.classList.add('ball')
  ballpit.appendChild(ball);
  ball.animate([
    {left: '0px', top: '0px'},
    {left: '0px', top: '0px'},
  ], 1000);
  document.body.addEventListener('mousemove', function(event) {
    ball.animate([{left: event.clientX + 'px', top: event.clientY + 'px'}], duration).onfinish = function(animation) {
      for (var i = ball.animations.length - 1; i >= 0; i--) {
        if (ball.animations[i] == animation) {
          ball.animations = ball.animations.slice(i);
          break;
        }
      }
    };
  });
});
</script>
</body>
